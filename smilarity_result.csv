Question,SQL,Expect Columns,Columns-token Min threshold,Columns-token choose columns,Description Min threshold,Description choose columns
How many daily active users each day?,"SELECT event_date, COUNT(DISTINCT user_pseudo_id)
FROM (
    SELECT event_date, ga_session_id, user_pseudo_id
    FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
    GROUP BY event_date, ga_session_id, user_pseudo_id
    HAVING SUM(engagement_time_msec) > 10*1000
)
GROUP BY event_date
ORDER BY event_date ASC","['event_date', 'ga_session_id', 'user_pseudo_id', 'engagement_time_msec']",0.3538821041584015,125,0.15984684228897095,48
How many monthly active users each month?,"SELECT event_month, COUNT(DISTINCT user_pseudo_id)
FROM (
    SELECT event_month, ga_session_id, user_pseudo_id
    FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
    GROUP BY event_month, ga_session_id, user_pseudo_id
    HAVING SUM(engagement_time_msec) > 10*1000
)
GROUP BY event_month
ORDER BY event_month ASC","['ga_session_id', 'event_month', 'user_pseudo_id', 'engagement_time_msec']",0.3538821041584015,108,0.1179906576871872,67
What is the average number of daily active users last 7 days?,"SELECT AVG(cnt) FROM
  (SELECT event_date, COUNT(DISTINCT user_pseudo_id) as cnt
  FROM (
      SELECT event_date, ga_session_id, user_pseudo_id
      FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
      GROUP BY event_date, ga_session_id, user_pseudo_id
      HAVING SUM(engagement_time_msec) > 10*1000
  )
  GROUP BY event_date
  ORDER BY event_date ASC)
WHERE event_date >= DATEADD(DAY, -7, GETDATE())","['event_date', 'ga_session_id', 'user_pseudo_id', 'engagement_time_msec']",0.293606162071228,146,0.11249055713415146,75
What is the mean number of daily active users from last 30 days?,"SELECT AVG(cnt) FROM
  (SELECT event_date, COUNT(DISTINCT user_pseudo_id) as cnt
  FROM (
      SELECT event_date, ga_session_id, user_pseudo_id
      FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
      GROUP BY event_date, ga_session_id, user_pseudo_id
      HAVING SUM(engagement_time_msec) > 10*1000
  )
  GROUP BY event_date
  ORDER BY event_date ASC)
WHERE event_date >= DATEADD(DAY, -30, GETDATE())","['event_date', 'ga_session_id', 'user_pseudo_id', 'engagement_time_msec']",0.35158151388168335,125,0.15479889512062073,51
When was the last time each user was active?,"SELECT user_pseudo_id, MAX(last_active) FROM
  (SELECT event_date, ga_session_id, user_pseudo_id, MAX(event_timestamp) as last_active
  FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
  GROUP BY event_date, ga_session_id, user_pseudo_id
  HAVING SUM(engagement_time_msec) > 10*1000)
GROUP BY user_pseudo_id","['user_pseudo_id', 'ga_session_id', 'event_timestamp', 'event_date', 'engagement_time_msec']",0.3834719955921173,139,0.25817030668258667,30
How many users have engagement_time_msec more than 10 seconds?,"SELECT COUNT(DISTINCT user_pseudo_id) FROM 
  (SELECT ga_session_id, user_pseudo_id FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
  GROUP BY ga_session_id, user_pseudo_id
  HAVING SUM(engagement_time_msec) >= 10*1000)","['ga_session_id', 'user_pseudo_id', 'engagement_time_msec']",0.3538821041584015,151,0.19881078600883484,35
What is the mean number of daily active users on weekdays?,"SELECT AVG(cnt) FROM
  (SELECT event_date, COUNT(DISTINCT user_pseudo_id) as cnt
  FROM (
      SELECT event_date, ga_session_id, user_pseudo_id
      FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
      GROUP BY event_date, ga_session_id, user_pseudo_id
      HAVING SUM(engagement_time_msec) > 10*1000
  )
  GROUP BY event_date
  ORDER BY event_date ASC)
WHERE DAYOFWEEK(event_date) BETWEEN 2 AND 6","['event_date', 'ga_session_id', 'user_pseudo_id', 'engagement_time_msec']",0.14654441177845,150,0.1261439323425293,66
What is the mean number of daily active users on weekends?,"SELECT AVG(cnt) FROM
  (SELECT event_date, COUNT(DISTINCT user_pseudo_id) as cnt
  FROM (
      SELECT event_date, ga_session_id, user_pseudo_id
      FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
      GROUP BY event_date, ga_session_id, user_pseudo_id
      HAVING SUM(engagement_time_msec) > 10*1000
  )
  GROUP BY event_date
  ORDER BY event_date ASC)
WHERE DAYOFWEEK(event_date) IN (1, 7)","['event_date', 'ga_session_id', 'user_pseudo_id', 'engagement_time_msec']",0.25978031754493713,150,0.11753962934017181,66
How many times each user opens the app each week?,"SELECT user_pseudo_id, EXTRACT(WEEK FROM event_timestamp), EXTRACT(YEAR FROM event_timestamp), COUNT(event_name) FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
WHERE event_name = ""session_start""
GROUP BY user_pseudo_id, EXTRACT(WEEK FROM event_timestamp), EXTRACT(YEAR FROM event_timestamp)","['user_pseudo_id', 'event_name', 'event_timestamp']",0.34231093525886536,132,0.10443906486034393,90
What is the average number of app opens each week?,"SELECT week, year, AVG(cnt) FROM
  (SELECT user_pseudo_id, EXTRACT(WEEK FROM event_timestamp) AS week, EXTRACT(YEAR FROM event_timestamp) AS year, COUNT(event_name) as cnt FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
  WHERE event_name = ""session_start""
  GROUP BY user_pseudo_id, EXTRACT(WEEK FROM event_timestamp), EXTRACT(YEAR FROM event_timestamp))
GROUP BY week, year","['user_pseudo_id', 'event_name', 'event_timestamp']",0.30198875069618225,142,0.07577653229236603,109
How often each user opens the app each month? ,"SELECT user_pseudo_id, EXTRACT(MONTH FROM event_timestamp), EXTRACT(YEAR FROM event_timestamp), COUNT(event_name) FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
WHERE event_name = ""session_start""
GROUP BY user_pseudo_id, EXTRACT(MONTH FROM event_timestamp), EXTRACT(YEAR FROM event_timestamp)","['user_pseudo_id', 'event_name', 'event_timestamp']",0.3874548077583313,96,0.07461103796958923,90
How many times each user opens the app each month?,"SELECT user_pseudo_id, EXTRACT(MONTH FROM event_timestamp), EXTRACT(YEAR FROM event_timestamp), COUNT(event_name) FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
WHERE event_name = ""session_start""
GROUP BY user_pseudo_id, EXTRACT(MONTH FROM event_timestamp), EXTRACT(YEAR FROM event_timestamp)","['user_pseudo_id', 'event_name', 'event_timestamp']",0.3874548077583313,99,0.08576661348342896,99
What is the average number of app opens each month?,"SELECT month, year, AVG(cnt) FROM
  (SELECT user_pseudo_id, EXTRACT(MONTH FROM event_timestamp) AS month, EXTRACT(YEAR FROM event_timestamp) AS year, COUNT(event_name) AS cnt FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
  WHERE event_name = ""session_start""
  GROUP BY user_pseudo_id, EXTRACT(MONTH FROM event_timestamp), EXTRACT(YEAR FROM event_timestamp))
GROUP BY month, year","['user_pseudo_id', 'event_name', 'event_timestamp']",0.30198875069618225,144,0.05226699262857437,128
How many times each user open the app?,"SELECT user_pseudo_id, COUNT(event_name) FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
WHERE event_name = ""session_start""
GROUP BY user_pseudo_id","['user_pseudo_id', 'event_name']",0.39394980669021606,91,0.06265516579151154,132
How many days have passed since each user last opened the app?,"SELECT user_pseudo_id, DATEDIFF(DAY, MAX(event_timestamp), GETDATE()) FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
WHERE event_name = ""session_start""
GROUP BY user_pseudo_id","['user_pseudo_id', 'event_name', 'event_timestamp']",0.3345378339290619,106,0.14349296689033508,71
"On average, how many days have passed since users last opened the app?","SELECT AVG(day) FROM
  (SELECT user_pseudo_id, DATEDIFF(DAY, MAX(event_timestamp), GETDATE()) as day FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
  WHERE event_name = ""session_start""
  GROUP BY user_pseudo_id)","['user_pseudo_id', 'event_name', 'event_timestamp']",0.30198875069618225,133,0.08419845998287201,103
How many users have opened the app everyday last 7 days?,"SELECT COUNT(DISTINCT user_pseudo_id) FROM
  (SELECT user_pseudo_id, COUNT(DISTINCT event_date) FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
  WHERE event_date >= DATEADD(DAY, -7, GETDATE())
  GROUP BY user_pseudo_id)","['event_date', 'user_pseudo_id']",0.3345378339290619,95,0.297245055437088,20
How many users have opened the app more than once last 7 days?,"SELECT COUNT(DISTINCT user_pseudo_id) FROM
  (SELECT user_pseudo_id, COUNT(DISTINCT event_date) FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
  WHERE event_name = ""session_start"" AND event_date >= DATEADD(DAY, -7, GETDATE())
  GROUP BY user_pseudo_id
  HAVING COUNT(DISTINCT event_date) > 1)","['event_date', 'user_pseudo_id', 'event_name']",0.3345378339290619,117,0.08636186271905899,136
How many users have opened the app more than once last 30 days?,"SELECT COUNT(DISTINCT user_pseudo_id) FROM
  (SELECT user_pseudo_id, COUNT(DISTINCT event_date) FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
  WHERE event_name = ""session_start"" AND event_date >= DATEADD(DAY, -30, GETDATE())
  GROUP BY user_pseudo_id
  HAVING COUNT(DISTINCT event_date) > 1)","['event_date', 'user_pseudo_id', 'event_name']",0.3345378339290619,117,0.09393873065710068,121
How many users have opened the app everyday at least 25 percent last 30 days?,"SELECT COUNT(DISTINCT user_pseudo_id) FROM
  (SELECT user_pseudo_id, COUNT(DISTINCT event_date) as count FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
  WHERE event_name = ""session_start"" AND event_date >= DATEADD(DAY, -30, GETDATE())
  GROUP BY user_pseudo_id
  HAVING COUNT(DISTINCT event_date) >= 0.25*30)","['event_date', 'user_pseudo_id', 'event_name']",0.27793070673942566,131,0.06320098042488098,141
How many users have opened the app everyday at least 50 percent last 30 days?,"SELECT COUNT(DISTINCT user_pseudo_id) FROM
  (SELECT user_pseudo_id, COUNT(DISTINCT event_date) as count FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
  WHERE event_name = ""session_start"" AND event_date >= DATEADD(DAY, -30, GETDATE())
  GROUP BY user_pseudo_id
  HAVING COUNT(DISTINCT event_date) >= 0.5*30)","['event_date', 'user_pseudo_id', 'event_name']",0.27793070673942566,131,0.06472328305244446,136
How many users use the app each hour of each day?,"SELECT EXTRACT(HOUR FROM event_timestamp) as hour, EXTRACT(DAY FROM event_timestamp) as day, COUNT(DISTINCT user_pseudo_id) 
FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
WHERE event_name = ""session_start""
GROUP BY hour, day","['event_timestamp', 'user_pseudo_id', 'event_name']",0.2929588556289673,148,0.06506532430648804,133
"On average, how many users have opened the app each hour?","SELECT hour, AVG(cnt) as avg_cnt FROM
  (SELECT EXTRACT(HOUR FROM event_timestamp) as hour, EXTRACT(DAY FROM event_timestamp) as day, COUNT(DISTINCT user_pseudo_id) as cnt
  FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
  WHERE event_name = ""session_start""
  GROUP BY hour, day)
GROUP BY hour
ORDER BY hour ASC","['event_timestamp', 'user_pseudo_id', 'event_name']",0.2929588556289673,143,0.04125022888183594,131
"On average, during which hour of the day did users use the app the most?","SELECT hour, AVG(cnt) as avg_cnt FROM
  (SELECT EXTRACT(HOUR FROM event_timestamp) as hour, EXTRACT(DAY FROM event_timestamp) as day, COUNT(DISTINCT user_pseudo_id) as cnt
  FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
  WHERE event_name = ""session_start""
  GROUP BY hour, day)
GROUP BY hour
ORDER BY avg_cnt DESC
LIMIT 1","['event_timestamp', 'user_pseudo_id', 'event_name']",0.2929588556289673,145,0.10316069424152374,86
What is the average amount of time that users spend on each session?,"SELECT AVG(time) FROM
    (SELECT user_pseudo_id, ga_session_id, SUM(engagement_time_msec)/(1000*60) as time FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
    WHERE engagement_time_msec != 0 AND ga_session_id IS NOT NULL
    GROUP BY user_pseudo_id, ga_session_id)","['ga_session_id', 'user_pseudo_id', 'engagement_time_msec']",0.293606162071228,140,0.14617383480072021,44
How many sessions on average users have in one day?,"SELECT AVG(session) FROM
  (SELECT user_pseudo_id, COUNT(DISTINCT ga_session_id) as session FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
  GROUP BY user_pseudo_id, event_date)","['event_date', 'ga_session_id', 'user_pseudo_id']",0.293606162071228,149,0.20567576587200165,35
How many sessions on average users have in one week?,"SELECT AVG(session) FROM
  (SELECT user_pseudo_id, COUNT(DISTINCT ga_session_id) as session FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
  GROUP BY user_pseudo_id, EXTRACT(WEEK FROM event_timestamp), EXTRACT(YEAR FROM event_timestamp))","['ga_session_id', 'user_pseudo_id', 'event_timestamp']",0.293606162071228,147,0.14082565903663635,48
How long in minutes do users spend on the app on average in one day?,"SELECT AVG(time) FROM
  (SELECT user_pseudo_id, event_date, SUM(engagement_time_msec/(1000*60)) as time FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
  GROUP BY user_pseudo_id, event_date)","['event_date', 'user_pseudo_id', 'engagement_time_msec']",0.2869006395339966,140,0.20961596071720123,23
What is the average amount of time users spend in a day using the app on weekdays?,"SELECT AVG(time) FROM
  (SELECT user_pseudo_id, event_date, SUM(engagement_time_msec/(1000*60)) as time FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
  GROUP BY user_pseudo_id, event_date)
WHERE DAYOFWEEK(event_date) BETWEEN 2 AND 6","['event_date', 'user_pseudo_id', 'engagement_time_msec']",0.14654441177845,150,0.20598798990249634,23
What is the average amount of time users spend in a day using the app on weekends?,"SELECT AVG(time) FROM
  (SELECT user_pseudo_id, event_date, SUM(engagement_time_msec/(1000*60)) as time FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
  GROUP BY user_pseudo_id, event_date)
WHERE DAYOFWEEK(event_date) IN (1, 7)","['event_date', 'user_pseudo_id', 'engagement_time_msec']",0.25978031754493713,148,0.20019939541816711,20
How many users deleted the app last 30 days?,"SELECT COUNT(DISTINCT user_pseudo_id) FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
WHERE event_name = ""app_remove"" AND event_timestamp >= DATEADD(DAY, -30, GETDATE())","['user_pseudo_id', 'event_name', 'event_timestamp']",0.3036446273326874,116,0.06191929429769516,137
How many days has each user used the app since the first touch?,"SELECT user_pseudo_id, DATEDIFF(DAY, MIN(user_first_touch_timestamp), MAX(event_timestamp)) FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
GROUP BY user_pseudo_id","['user_pseudo_id', 'user_first_touch_timestamp', 'event_timestamp']",0.3634069859981537,110,0.3030417263507843,27
What are the most 10 events users do and their proportions?,"SELECT event_name, 
       COUNT(event_name) as cnt, 
       COUNT(event_name) / SUM(COUNT(event_name)) OVER() as proportion
FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
GROUP BY event_name
ORDER BY cnt DESC
LIMIT 10",['event_name'],0.26508647203445435,111,0.45305556058883667,0
What is number of times users open X store last 7 days?,"SELECT COUNT(event_name) FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
WHERE event_name = ""virtualmall_landing"" AND event_timestamp >= DATEADD(DAY, -7, GETDATE())","['event_timestamp', 'event_name']",0.3366281986236572,134,0.07269632071256638,146
How many users open X store last 7 days?,"SELECT COUNT(DISTINCT user_pseudo_id) FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
WHERE event_name = ""virtualmall_landing"" AND event_timestamp >= DATEADD(DAY, -7, GETDATE())","['user_pseudo_id', 'event_name', 'event_timestamp']",0.3366281986236572,134,0.045697979629039764,163
What is number of times users open X store last 30 days?,"SELECT COUNT(event_name) FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
WHERE event_name = ""virtualmall_landing"" AND event_timestamp >= DATEADD(DAY, -30, GETDATE())","['event_timestamp', 'event_name']",0.3366281986236572,134,0.07860219478607178,138
How many users open X store last 30 days?,"SELECT COUNT(DISTINCT user_pseudo_id) FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
WHERE event_name = ""virtualmall_landing"" AND event_timestamp >= DATEADD(DAY, -30, GETDATE())","['user_pseudo_id', 'event_name', 'event_timestamp']",0.3366281986236572,134,0.04582498222589493,162
How many users open X store more than once last 7 days?,"SELECT COUNT(cnt) FROM
    (SELECT COUNT(DISTINCT user_pseudo_id) as cnt FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
    WHERE event_name = ""virtualmall_landing"" AND event_timestamp >= DATEADD(DAY, -7, GETDATE())
    GROUP BY user_pseudo_id
    HAVING COUNT(event_name) > 1)","['user_pseudo_id', 'event_name', 'event_timestamp']",0.3366281986236572,134,0.04128008335828781,159
How many users open X store more than once last 30 days?,"SELECT COUNT(cnt) FROM
    (SELECT COUNT(DISTINCT user_pseudo_id) as cnt FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
    WHERE event_name = """"virtualmall_landing"""" AND event_timestamp >= DATEADD(DAY, -30, GETDATE())
    GROUP BY user_pseudo_id
    HAVING COUNT(event_name) > 1)","['user_pseudo_id', 'event_name', 'event_timestamp']",0.3366281986236572,134,0.043333396315574646,156
What is the number of times that the search on X Store has been used in the last 7 days?,"SELECT COUNT(event_name) FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
WHERE event_name = ""virtualmall_search"" AND event_timestamp >= DATEADD(DAY, -7, GETDATE())","['event_timestamp', 'event_name']",0.3366281986236572,133,0.10406866669654846,123
How many users have opened X store more than 5 times since last 30 days?,"SELECT COUNT(cnt) FROM
  (SELECT COUNT(DISTINCT user_pseudo_id) as cnt FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
  WHERE event_name = ""virtualmall_landing"" AND event_timestamp >= DATEADD(DAY, -30, GETDATE())
  GROUP BY user_pseudo_id
  HAVING COUNT(event_name) > 5)","['user_pseudo_id', 'event_name', 'event_timestamp']",0.3345378339290619,116,0.06798234581947327,151
How many users have not used the app for more than 2 weeks?,"SELECT COUNT(DISTINCT user_pseudo_id) FROM
  (SELECT user_pseudo_id, MAX(event_timestamp) as max_time FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
  WHERE event_name = ""session_start""
  GROUP BY user_pseudo_id
  HAVING  DATEDIFF(WEEK, max_time, GETDATE()) > 2)","['user_pseudo_id', 'event_timestamp', 'event_name']",0.34231093525886536,132,0.04664606600999832,143
How many users have not used the app for more than a month?,"SELECT COUNT(DISTINCT user_pseudo_id) FROM
  (SELECT user_pseudo_id, MAX(event_timestamp) as max_time FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
  WHERE event_name = ""session_start""
  GROUP BY user_pseudo_id
  HAVING  DATEDIFF(MONTH, max_time, GETDATE()) > 1)","['user_pseudo_id', 'event_timestamp', 'event_name']",0.3874548077583313,102,0.033596158027648926,147
How many users have not used the app for more than 3 months?,"SELECT COUNT(DISTINCT user_pseudo_id) FROM
  (SELECT user_pseudo_id, MAX(event_timestamp) as max_time FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
  WHERE event_name = """"session_start""""
  GROUP BY user_pseudo_id
  HAVING  DATEDIFF(MONTH, max_time, GETDATE()) > 3)","['user_pseudo_id', 'event_timestamp']",0.3874548077583313,102,0.07623597979545593,102
How many churned users in the last 30 days?,"WITH users AS (
  SELECT user_pseudo_id, event_timestamp 
  FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
  WHERE event_name = ""session_start"" 
  AND event_timestamp >= DATEADD(DAY, -60, GETDATE())
),
users_start AS (
SELECT COUNT(DISTINCT user_pseudo_id) as user FROM users
),
users_end AS (
SELECT COUNT(DISTINCT user_pseudo_id) as user FROM users
WHERE event_timestamp >= DATEADD(DAY, -30, GETDATE())
)

SELECT users_start.user - users_end.user FROM users_start
JOIN users_end","['user_pseudo_id', 'event_timestamp', 'event_name']",0.0,152,0.08366601914167404,102
What is the churn rate in the last 30 days?,"WITH users AS (
  SELECT user_pseudo_id, event_timestamp 
  FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
  WHERE event_name = ""session_start"" 
  AND event_timestamp >= DATEADD(DAY, -60, GETDATE())
),
users_start AS (
SELECT COUNT(DISTINCT user_pseudo_id) as user FROM users
),
users_end AS (
SELECT COUNT(DISTINCT user_pseudo_id) as user FROM users
WHERE event_timestamp >= DATEADD(DAY, -30, GETDATE())
)

SELECT (users_start.user - users_end.user)/(users_start.user) FROM users_start
JOIN users_end","['user_pseudo_id', 'event_timestamp', 'event_name']",0.08565810322761536,164,0.03461921587586403,122
How many new users in the last 7 days?,"SELECT COUNT(DISTINCT user_pseudo_id) FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
WHERE DATEDIFF(DAY, user_first_touch_timestamp, GETDATE()) <= 7","['user_pseudo_id', 'user_first_touch_timestamp']",0.3634069859981537,137,0.2113753855228424,26
How many new user in the last 30 days?,"SELECT COUNT(DISTINCT user_pseudo_id) FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
WHERE DATEDIFF(DAY, user_first_touch_timestamp, GETDATE()) <= 30","['user_pseudo_id', 'user_first_touch_timestamp']",0.3634069859981537,138,0.23714204132556915,18
How many users were retained in the last 14 days?,"WITH users AS (
  SELECT user_pseudo_id, event_timestamp 
  FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
  WHERE event_name = ""session_start"" 
  AND event_timestamp >= DATEADD(DAY, -60, GETDATE())
  AND DATEDIFF(DAY, user_first_touch_timestamp, GETDATE()) > 60
),
users_start AS (
SELECT user_pseudo_id as user FROM users
WHERE event_timestamp >= DATEADD(DAY, -60, GETDATE()) AND event_timestamp < DATEADD(DAY, -30, GETDATE())
),
users_end AS (
SELECT user_pseudo_id as user FROM users
WHERE event_timestamp >= DATEADD(DAY, -30, GETDATE())
)

SELECT COUNT(users_end.user)
FROM users_end
LEFT JOIN users_start ON users_end.user = users_start.user
WHERE users_start.user IS NULL","['user_pseudo_id', 'event_timestamp', 'event_name', 'user_first_touch_timestamp']",0.2495703250169754,143,0.0839327871799469,125
How many users were retained in the last 30 days?,"WITH users AS (
  SELECT user_pseudo_id, event_timestamp 
  FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
  WHERE event_name = ""session_start"" 
  AND event_timestamp >= DATEADD(DAY, -180, GETDATE())
  AND DATEDIFF(DAY, user_first_touch_timestamp, GETDATE()) > 180
),
users_start AS (
SELECT user_pseudo_id as user FROM users
WHERE event_timestamp >= DATEADD(DAY, -180, GETDATE()) AND event_timestamp < DATEADD(DAY, -90, GETDATE())
),
users_end AS (
SELECT user_pseudo_id as user FROM users
WHERE event_timestamp >= DATEADD(DAY, -90, GETDATE())
)

SELECT COUNT(users_end.user)
FROM users_end
LEFT JOIN users_start ON users_end.user = users_start.user
WHERE users_start.user IS NULL","['user_pseudo_id', 'event_timestamp', 'event_name', 'user_first_touch_timestamp']",0.2495703250169754,143,0.08700427412986755,123
How many users have consistently used the app at least once every day on May 2022 ?,"SELECT COUNT(DISTINCT user_pseudo_id) AS users_with_daily_events
FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
WHERE YEAR(event_date) = 2022 AND MONTH(event_date) = 5
GROUP BY event_date
HAVING COUNT(DISTINCT event_date) = DATEDIFF('2022-05-01', '2022-05-31') + 1;","['event_date', 'user_pseudo_id']",0.1280774474143982,27,0.2767159938812256,9
How much is the percentage of users increasing in May compared to April in 2022?,"SELECT  ((all_user_may.count_distinct_user_pseudo_id - all_users_april.count_distinct_user_pseudo_id )/ all_users_april.count_distinct_user_pseudo_id)*100 AS float_percentage
FROM (
  SELECT COUNT(DISTINCT user_pseudo_id) AS count_distinct_user_pseudo_id
  FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
  WHERE MONTH(event_date) = 5
) AS all_user_may
CROSS JOIN (
  SELECT COUNT(DISTINCT user_pseudo_id) AS count_distinct_user_pseudo_id
  FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
  WHERE MONTH(event_date) = 4
) AS all_users_april;","['user_pseudo_id', 'event_date']",0.1280774474143982,27,0.0998067557811737,64
What's the average number of engagement time for the top 10 most active users?,"SELECT AVG(total_engagement_sec)
FROM( SELECT user_pseudo_id, SUM(engagement_time_msec)/1000 AS total_engagement_sec
  FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
  GROUP BY user_pseudo_id
  HAVING(total_engagement_sec >= 10)
  ORDER BY total_engagement_sec DESC
  LIMIT 10)","['user_pseudo_id', 'engagement_time_msec']",0.31393224000930786,76,0.16186481714248657,48
Can you provide a percentage breakdown of app usage by device type?,"SELECT device_mobile_model_name, (COUNT(DISTINCT user_pseudo_id)/SUM(COUNT(DISTINCT user_pseudo_id)) OVER ())*100 AS total_devices_percentage
FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
GROUP BY device_mobile_model_name","['user_pseudo_id', 'device_mobile_model_name']",0.2797265648841858,104,0.23395299911499023,25
What's the average engagement time for users who have used the app on both weekdays and weekends?,"SELECT AVG(total_engagement_sec)
FROM(SELECT user_pseudo_id, SUM(engagement_time_msec)/1000 AS total_engagement_sec
  FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
  WHERE WEEKDAY(event_date) IN (0,1,2,3,4) AND WEEKDAY(event_date) IN (5,6)
  GROUP BY user_pseudo_id
  HAVING(total_engagement_sec >= 10)
  ORDER BY total_engagement_sec DESC)","['event_date', 'user_pseudo_id', 'engagement_time_msec']",0.14654441177845,149,0.18933475017547607,32
What was the percentage increase in total users from last year?,"SELECT ((count_distinct_user_pseudo_id_this_year -  count_distinct_user_pseudo_id_last_year)/ count_distinct_user_pseudo_id_last_year) * 100
FROM( 
    SELECT COUNT(DISTINCT user_pseudo_id) AS count_distinct_user_pseudo_id_this_year
    FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
    WHERE  YEAR(event_date) = YEAR(CURRENT_DATE)
) AS total_users_this_year,
(
    SELECT COUNT(DISTINCT user_pseudo_id) AS count_distinct_user_pseudo_id_last_year
    FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
    WHERE  YEAR(event_date) = YEAR(CURRENT_DATE) - 1
) AS total_users_last_year;","['event_date', 'user_pseudo_id']",0.3123716711997986,108,0.09923972189426422,94
What's the percentage of users who have interacted with the app every day from 23 to 25 May 2022?,"SELECT (CAST(active_user_everyday AS FLOAT) / all_users.count_distinct_user_pseudo_id) * 100
FROM( 
  SELECT COUNT(DISTINCT CASE WHEN event_date BETWEEN '2022-05-23' AND '2022-05-25' THEN user_pseudo_id END) AS active_user_everyday
  FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
  WHERE event_date BETWEEN '2022-05-23' AND '2022-05-25'
  GROUP BY user_pseudo_id
  HAVING COUNT(DISTINCT event_date) = DATEDIFF('2022-05-24', '2022-05-23') + 1 ) AS active_user_everyday,
(
    SELECT COUNT(DISTINCT user_pseudo_id) AS count_distinct_user_pseudo_id
    FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
) AS all_users;","['user_pseudo_id', 'event_date']",0.1280774474143982,15,0.2760825753211975,15
How many users used the app for more than 2 active on the same day on May?,"SELECT COUNT(DISTINCT user_pseudo_id)
FROM ( SELECT DISTINCT user_pseudo_id, COUNT(event_name)
  FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
  WHERE MONTH(event_date) = ""5"" AND event_name = 'user_engagement'
  GROUP BY event_date, user_pseudo_id
  HAVING SUM(engagement_time_msec)/1000 >= 10 AND COUNT(event_name) >= 2
)","['event_date', 'user_pseudo_id', 'event_name', 'engagement_time_msec']",0.3634069859981537,119,0.15814894437789917,66
What's the average number of time it takes for all user to select first product after first open the app?,"SELECT AVG(time_difference)
FROM(SELECT  user_pseudo_id,
        TIMESTAMPDIFF(MINUTE,
          MIN(CASE WHEN event_name = 'first_open' THEN event_timestamp END),
          MIN(CASE WHEN event_name = 'payatmcht_select_product' THEN event_timestamp END)
        ) AS time_difference
    FROM (SELECT user_pseudo_id, event_name, event_timestamp
          FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
          WHERE user_pseudo_id IN (
            SELECT DISTINCT user_pseudo_id
            FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
            WHERE event_name IN (""payatmcht_select_product"",""first_open"")
    )
    AND (event_name IN (""payatmcht_select_product"",""first_open""))
    ORDER BY user_pseudo_id, event_timestamp)
    GROUP BY user_pseudo_id
    HAVING time_difference IS NOT NULL)","['user_pseudo_id', 'event_name', 'event_timestamp']",0.30198875069618225,143,0.043325960636138916,125
How many users are there in each province in Thailand?,"SELECT geo_region, COUNT(DISTINCT user_pseudo_id) AS total_users
FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
WHERE geo_country = ""Thailand""
GROUP BY geo_region","['geo_country', 'user_pseudo_id', 'geo_region']",0.19754411280155182,153,0.20332956314086914,22
What percentage of active users in 2022-05 used the app on weekday ?,"SELECT (COUNT(DISTINCT active_user_weekday.user_pseudo_id) * 100)/ COUNT(count_distinct_user_pseudo_id) AS percentage_active_user_weekday
FROM (
  SELECT event_date, user_pseudo_id
  FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
  WHERE WEEKDAY(event_date) IN (0,1,2,3,4) AND MONTH(event_date) = ""5"" AND YEAR(event_date) = ""2022""
  GROUP BY event_date, user_pseudo_id
  HAVING SUM(engagement_time_msec)/1000 >= 10
) AS active_user_weekday
CROSS JOIN(
    SELECT COUNT(DISTINCT user_pseudo_id) AS count_distinct_user_pseudo_id
    FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
) AS all_users;","['user_pseudo_id', 'event_date', 'engagement_time_msec']",0.14654441177845,150,0.274081826210022,25
What percentage of users used the app only on weekends?,"SELECT (CAST(users_use_on_weekends AS FLOAT) / all_users.count_distinct_user_pseudo_id) * 100 AS percentage_only_weekends
FROM (
    SELECT COUNT(DISTINCT user_pseudo_id) AS users_use_on_weekends
    FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
    WHERE WEEKDAY(event_date) IN (5, 6)
) AS users_only_weekends,
(
    SELECT COUNT(DISTINCT user_pseudo_id) AS count_distinct_user_pseudo_id
    FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
) AS all_users;","['user_pseudo_id', 'event_date']",0.25978031754493713,146,0.2168373465538025,33
What's the average sessions duration for users each day?,"SELECT  event_date, AVG(time_difference_seconds) AS avg_time_diff_sec
FROM (SELECT  event_date, 
                session_id, 
                COUNT(event_name) AS total_event,
                TIMESTAMPDIFF(
                        SECOND,
                        MIN(event_timestamp),
                        MAX(event_timestamp)
                ) AS time_difference_seconds
        FROM (
        SELECT  user_pseudo_id, 
                event_name, 
                event_date, 
                event_timestamp,
                SUM (   CASE WHEN event_name = 'session_start' THEN 1 ELSE 0 END) 
                        OVER (PARTITION BY event_date ORDER BY event_timestamp) AS session_id 
                FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly)
        WHERE event_name != ""app_remove""
        GROUP BY event_date, session_id)
GROUP BY event_date","['user_pseudo_id', 'event_timestamp', 'event_name', 'event_date']",0.30198875069618225,115,0.07577590644359589,98
What's the percentage of users who have used the app on weekends?,"SELECT
  (COUNT(DISTINCT CASE WHEN WEEKDAY(event_date) IN (5, 6) THEN user_pseudo_id END) / COUNT(DISTINCT user_pseudo_id)) * 100 
FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly;",['user_pseudo_id'],0.25978031754493713,146,0.2303909957408905,23
How many users have performed a specific event at least once in May?,"SELECT COUNT(DISTINCT user_pseudo_id)
FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
WHERE MONTH(event_date) = 5","['event_date', 'user_pseudo_id']",0.3360813856124878,99,0.17739468812942505,42
How many users have opened the app on at least 2 different device types?,"SELECT SUM(user_with_multiple_devices) AS total_users_with_multiple_devices
FROM (SELECT COUNT(DISTINCT user_pseudo_id) as user_with_multiple_devices
        FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
        GROUP BY user_pseudo_id
        HAVING COUNT(DISTINCT device_category) >= 1
    )","['device_category', 'user_pseudo_id']",0.3125404715538025,139,0.3964725136756897,7
What are the top 10 event names that users have done?,"SELECT event_name
FROM team_tds.tds_intern.pointx_fbs_txn_rpt_dly
GROUP BY event_name
ORDER BY COUNT(DISTINCT user_pseudo_id) DESC
LIMIT 10","['user_pseudo_id', 'event_name']",0.398399293422699,116,0.19851082563400269,52
